debugSource('~/uni/dm/week3/week3.R')
printTree(tree)
printTree(tree)
tree
printTree(tree)
debugSource('~/uni/dm/week3/week3.R')
printTree(tree)
tree[['splitFeature']]
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
printTree(tree)
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
wines <- read.csv('winequality-white.csv')
View(wines)
wines <- read.csv('winequality-white.csv')
names(d)[names(d)=="quality"] <- "label"
names(wines)[names(wines)=="quality"] <- "label"
names(wines)
tree <- GrowTree(wines,
c('fixed.acidity', 'volatile.acidity', 'citric.acid', 'residual.sugar',
'chlorides', 'free.sulfur.dioxide', 'total.sulfur.dioxide',
'density', 'pH', 'sulphates', 'alcohol'))
printTree(tree)
source('~/uni/dm/week3/week3.R')
quantile(runif(10), seq(0:.1:1))
quantile(runif(10), probs=seq(0:.1:1))
seq(0:.1:1)
seq(0:0.1:1)
0:.1:1
seq(0,1,.1)
quantile(runif(10), probs=seq(0, 1, .1))
quantile(runif(1000), probs=seq(0, 1, .1))
EqualFreq2 <- function(x,n){
nx <- length(x)
nrepl <- floor(nx/n)
nplus <- sample(1:n,nx - nrepl*n)
nrep <- rep(nrepl,n)
nrep[nplus] <- nrepl+1
x[order(x)] <- rep(seq.int(n),nrep)
x
}
EqualFreq2(runif(1000))
EqualFreq2(runif(1000),10)
runif(10)
EqualFreq2(runif(1000))
EqualFreq2(runif(1000),10)
table(ans)
table(EqualFreq2(runif(1000),10))
table(EqualFreq2(runif(100),10))
table(EqualFreq2(runif(10),10))
table(EqualFreq2(runif(100),10))
table(EqualFreq2(runif(101),10))
table(EqualFreq2(runif(103),10))
table(Hmisc::cut2(runif(1000), m = 10))
cut(runif(1000), breaks=10)
table(cut(runif(1000), breaks=10))
cutEqual <- function(x, n, include.lowest = TRUE, ...) {
stopifnot(require(lattice))
cut(x, co.intervals(x, n, 0)[c(1, (n+1):(n*2))],
include.lowest = include.lowest, ...)
}
table(cutEqual(runif(1000), 10))
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
View(wines)
View(wines)
debugSource('~/uni/dm/week3/week3.R')
View(wines)
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
d$label
debugSource('~/uni/dm/week3/week3.R')
d
d
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
.
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
data$label
table(data$label)
max(table(data$label))
debugSource('~/uni/dm/week3/week3.R')
sort(table(data$category),decreasing=TRUE)[1]
sort(table(data$label),decreasing=TRUE)[1]
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
Label
Label(d)
d
Label(d)[1]
Label(d)[[1]]
Label(d)[[0]]
Label(d)[1]
names(Label(d))[1]
names(Label(d))[[1]
]
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
Label(d)
label
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
sum(list(1,2,3))
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
tree[['children']]
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
x
debugSource('~/uni/dm/week3/week3.R')
data[1]
data[:,1]
data[1,]
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
x
debugSource('~/uni/dm/week3/week3.R')
by(X, 1:nrow(X), function (x) { predictSingle(tree, x) })
apply(X, 1, function (x) { predictSingle(tree, x) })
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
require(SDMTools)
require(caret)
library(caret)
install.packages("caret")
debugSource('~/uni/dm/week3/week3.R')
View(data)
View(wines)
source('~/uni/dm/week3/week3.R')
install.packages("SDMTools")
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
confusion.matrix(predicted, actuals)
levels(predicted)
table(predicted)
names(table(predicted))
unique(predicted)
unique(actuals)
unique(predicted) == unique(actuals)
"3" == 3
"" == 3
lapply(unique(predicted), function (value) { confusion.matrix(predicted == value, actuals == value) })
confusion.matrix(predicted == 6, actuals == 6)
confusionMatrix(predicted == 6, actuals == 6)
require(caret)
confusionMatrix(predicted == 6, actuals == 6)
predicted  == 6
integer(predicted == 6)
1*(predicted == 6)
confusion.matrix(1*(prediction==6),1*(actuals==6))
confusion.matrix(1*(predicted==6),1*(actuals==6))
install.packages("SDMTools")
debugSource('~/uni/dm/week3/week3.R')
table(1*(predicted == value), 1*(actuals == value))
confusion.matrix(1*(predicted == value), 1*(actuals == value))
cm[1,]
cm[1]
cm[,1]
cm[1,1]
cm[1,2]
cm[2,1]
cm[1:2,1]
cm[1,1]
cm[1,1]/(c[1,1]+cm[1,2])
table(1*(predicted == value), 1*(actuals == value))
a<-table(1*(predicted == value), 1*(actuals == value))
a[1,]
a[1,1]
a[1,2]
cm[1,1]/(cm[1,1]+cm[1,2])
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
TRUE == (predicted == value)
predicted
value
actuals == value
print(sum(TRUE == ((predicted == value) == (actuals == value))))
sum(TRUE)
sum(FALSE)
(predicted == value)
predicted == actuals
(predicted == actuals) == (predicted == valu)
(predicted == actuals) == (predicted == value)
sum(predicted == actuals) == (predicted == value)
sum((predicted == actuals) == (predicted == value))
cm
cm[1,1]
cm[2,2]
table(1 * (actuals == value), 1 * (predicted == value))
sum((predicted == actuals) == (predicted == value))
confusion.matrix(1 * (predicted == value), 1 * (actuals == value))
cm <- confusion.matrix(1 * (predicted == value), 1 * (actuals == value))
cm[1,1]
predicted
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
predicted == actuals
predicted != actuals
!(predicted != actuals)
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
!(predicted != actuals)
(predicted == value)
!(predicted != actuals)
sum(!(predicted != actuals) == !(predicted == value))
sum((predicted == actuals) & (predicted == value))
sum((predicted == actuals) & (predicted != value))
sum((predicted != actuals) & (predicted != value))
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
a <- for(i in 1:3) { i }
a
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
value
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
a$value
a[,1]
a[1,]
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
rbind(a)
cbind(a)
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
str(tree)
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
1:(i*(n/k) - 1)
i
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
binSize
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
str(n)
length(train) + length(test)
nrow(train) + nrow(test)
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
Q
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
fold
fold$train
countNodes(tree)
fold$test$label
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
do.call(rbind, a)
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
install.packages("multicore")
require(parallel)
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
mean(a4)
mean(a4,1)
mean(a4,2)
debugSource('~/uni/dm/week3/week3.R')
e <- list(as="12")
e[['as']] <- 32
e
e <- list(as="12")
q <- e
e[['as']] <- 32
q
e
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
Q
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
Q
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
ass3()
ass3()
source('~/uni/dm/week3/week3.R')
ass3()
ass3()
source('~/uni/dm/week3/week3.R')
sum(sapply(list(1,2,3), function (i) { i }))
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
ass4()
ass3
ass3()
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
t.test(a$f1, b$f1)
t.test(a$f1, b$f1, paired=TRUE)
debugSource('~/uni/dm/week3/week3.R')
t.test(a$f1, b$f1, paired = TRUE)
debugSource('~/uni/dm/week3/week3.R')
ass3()
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
str(prunedTree)
printTree(prunedTree)
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
ass4()
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
b$acc
b$acc1
View(b)
b[,1]
b[,2]
b[,3]
b[,4]
b[,5]
b[,6]
b[,7]
b[,8]
t.test(b[,4],b[,8],paired=TRUE)
debugSource('~/uni/dm/week3/week3.R')
b <- a4
printf('Acc %f %f / %f %f\n', mean(b[,1]), sd(b[,1]), mean(b[,5]), sd(b[,5]))
printf('Prec %f %f / %f %f\n', mean(b[,2]), sd(b[,2]), mean(b[,6]), sd(b[,6]))
printf('Recall %f %f / %f %f\n', mean(b[,3]), sd(b[,3]), mean(b[,7]), sd(b[,7]))
printf('F1 %f %f / %f %f\n', mean(b[,4]), sd(b[,4]), mean(b[,8]), sd(b[,8]))
b
b[,5:8]
printf('Acc %f %f / %f %f\n', mean(b[,1]), sd(b[,1]), mean(b[,5]), sd(b[,5]))
printf('Prec %f %f / %f %f\n', mean(b[,2]), sd(b[,2]), mean(b[,6]), sd(b[,6]))
printf('Recall %f %f / %f %f\n', mean(b[,3]), sd(b[,3]), mean(b[,7]), sd(b[,7]))
printf('F1 %f %f / %f %f\n', mean(b[,4]), sd(b[,4]), mean(b[,8]), sd(b[,8]))
t.test(b[,4], b[,8], paired=TRUE)
t.test(b[,8], b[,4], paired=TRUE)
t.test(b[,4], b[,8], paired=TRUE)
print(b[,1:4])
print(b[,5:8])
debugSource('~/uni/dm/week3/week3.R')
debugSource('~/uni/dm/week3/week3.R')
source('~/uni/dm/week3/week3.R')
